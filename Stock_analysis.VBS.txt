
Sub stock()Dim i As LongDim totalvolume, closing_price, opening_price As DoubleDim ws As WorksheetFor Each ws In Worksheets              SummaryRow = 2              totalvolume = 0                            'top row headers              ws.Range("I1").Value = "Ticker"              ws.Range("J1").Value = "Yearly change"              ws.Range("K1").Value = "Percent Change"              ws.Range("L1").Value = "Total Stock Volume"                                      'Adjusts column to fit anything inside                ws.Columns(9).AutoFit                ws.Columns(10).AutoFit                ws.Columns(11).AutoFit                ws.Columns(12).AutoFit                                             'Automate last row                lastRow = ws.Cells(Rows.Count, 1).End(xlUp).Row                                'Variable that is assigned: ws.Cells(2, 3).Value                opening_price = ws.Cells(2, 3).Value                            For i = 2 To lastRow                                     'Counter that equmulates every row in column 7                totalvolume = totalvolume + ws.Cells(i, 7).Value                                    'Searches for when the value of the next cell is different than that of another cell                If ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value Then                                                                                             'ticker column                     ws.Cells(SummaryRow, 9).Value = ws.Cells(i, 1).Value                                             'Variable that is assigned: ws.Cells(i, 6).Value                     closing_price = ws.Cells(i, 6).Value                                         'Yearly change calculation                     yearlychange = closing_price - opening_price                                         'Yearly change row                     ws.Cells(SummaryRow, 10).Value = yearlychange                                         'Total Value Column                     ws.Cells(SummaryRow, 12).Value = totalvolume                                         'variable that is assigned: ws.Cells(SummaryRow, 11).Value                     percentagechange = ws.Cells(SummaryRow, 11).Value                                        'If statement that calculates percent change                If (opening_price > 0) Then                     percentagechange = Str(Round(100 * yearlychange / opening_price, 2)) + "%"                                                                                         Else                     ' set to zero, as to recalculate for each row                     percentagechange = 0                                             End If                                             'Percent change column                     ws.Cells(SummaryRow, 11).Value = percentagechange                                                     'Makes opening price variable go down each row in column 3                     opening_price = ws.Cells(i + 1, 3).Value                                         'If statement that assigns green for positive and red for negative in column, 10                If (ws.Cells(SummaryRow, 10).Value < 0) Then                     ws.Cells(SummaryRow, 10).Interior.Color = RGB(255, 0, 0)                                              ElseIf (ws.Cells(SummaryRow, 10).Value > 0) Then                     ws.Cells(SummaryRow, 10).Interior.Color = RGB(0, 255, 0)                                              End If                                             'counter:                    SummaryRow = SummaryRow + 1                                         'zero out                    totalvolume = 0                                             End If                     Next i        Next wsEnd Sub